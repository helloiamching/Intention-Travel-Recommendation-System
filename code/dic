{"cells":[{"cell_type":"code","source":["import dask.dataframe as dd\n","import pandas as pd\n","import rpy2.robjects as robjects\n","from rpy2.robjects.packages import importr\n","import numpy as np"],"metadata":{"id":"gvLFr6FhFxSd","executionInfo":{"status":"ok","timestamp":1712824521502,"user_tz":-480,"elapsed":2468,"user":{"displayName":"ç‹æ™´","userId":"13545761289751374787"}}},"execution_count":1,"outputs":[]},{"cell_type":"code","source":["level1_country =['é˜¿çˆ¾åŠåˆ©äº','è¥¿é¤','å®‰å“¥æ‹‰','è²å—','æ³¢æœ­é‚£','è‹±å±¬å°åº¦æ´‹é ˜åœ°','å¸ƒå‰ç´æ³•ç´¢','è’²éš†åœ°','å–€éº¥éš†','ç¶­å¾·è§’','ä¸­é','æŸ¥å¾·','è‘›æ‘©','æ°‘ä¸»å‰›æœ','å‰›æœ','è±¡ç‰™æµ·å²¸','å‰å¸ƒåœ°','åŸƒåŠ','èµ¤é“å¹¾å…§äº','å„åˆ©å‚äº','è¡£ç´¢æ¯”äº','åŠ å½­','ç”˜æ¯”äº','åŠ ç´','å¹¾å…§äº','å¹¾å…§äºæ¯”ç´¢','è‚¯äº','è³´ç´¢æ‰˜','è³´æ¯”ç‘äº','åˆ©æ¯”äº','é¦¬é”åŠ æ–¯åŠ ','é¦¬æ‹‰å¨','é¦¬åˆ©','èŒ…åˆ©å¡”å°¼äº','æ¨¡é‡Œè¥¿æ–¯','é¦¬ç´„ç‰¹','æ‘©æ´›å“¥','è«ä¸‰æ¯”å…‹','ç´ç±³æ¯”äº','å°¼æ—¥','å¥ˆåŠåˆ©äº','ç•™å°¼æ—º','ç›§å®‰é”','è–èµ«å‹’æ‹¿','è–å¤šç¾æ™®æ—è¥¿æ¯”','å¡å…§åŠ çˆ¾','å¡å¸­çˆ¾','ç…å­å±±','ç´¢é¦¬åˆ©äº','å—é','å—è˜‡ä¸¹','è˜‡ä¸¹','å²ç“¦å¸å°¼','å¦å°šå°¼äº','å¤šå“¥','çªå°¼è¥¿äº','çƒå¹²é”','å°šæ¯”äº','è¾›å·´å¨','ç´¢é¦¬åˆ©è˜­','æ’’æ‹‰å¨é˜¿æ‹‰ä¼¯æ°‘ä¸»å…±å’Œåœ‹','é˜¿å¯Œæ±—','äºç¾å°¼äº','äºå¡æ‹œç„¶','å·´æ—','å­ŸåŠ æ‹‰åœ‹','ä¸­è¯äººæ°‘å…±å’Œåœ‹','ä¸ä¸¹','æ±¶èŠ','æŸ¬åŸ”å¯¨','è–èª•å³¶','ç§‘ç§‘æ–¯ï¼ˆåŸºæ—ï¼‰ç¾¤å³¶','è³½æ™®å‹’æ–¯','å–¬æ²»äº','å°åº¦','å°å°¼','ä¼Šæœ—','ä¼Šæ‹‰å…‹','ä»¥è‰²åˆ—','æ—¥æœ¬','ç´„æ—¦','å“ˆè–©å…‹','æœé®®','éŸ“åœ‹','ç§‘å¨ç‰¹','å‰çˆ¾å‰æ–¯','å¯®åœ‹','é»å·´å«©','é¦¬ä¾†è¥¿äº','é¦¬çˆ¾åœ°å¤«','è’™å¤','ç·¬ç”¸','å°¼æ³Šçˆ¾','é˜¿æ›¼','å·´åŸºæ–¯å¦','è²å¾‹è³“','å¡é”','ä¿„ç¾…æ–¯','æ²™çƒåœ°é˜¿æ‹‰ä¼¯','æ–°åŠ å¡','æ–¯é‡Œè˜­å¡','æ•˜åˆ©äº','å¡”å‰å…‹','æ³°åœ‹','æ±å¸æ±¶','åœŸè€³å…¶','åœŸåº«æ›¼','é˜¿æ‹‰ä¼¯è¯åˆå¤§å…¬åœ‹','äºå…‹ç¾…æåˆ©èˆ‡å¾·å‡±åˆ©äº','çƒèŒ²åˆ¥å…‹','è¶Šå—','è‘‰é–€','é˜¿å¸ƒå“ˆèŒ²','åŒ—è³½æ™®å‹’æ–¯','å·´å‹’æ–¯å¦','ä¸­è¯æ°‘åœ‹','å—å¥§å¡æäº','å¥§è˜­ç¾¤å³¶','é˜¿çˆ¾å·´å°¼äº','å®‰é“çˆ¾','å¥§åœ°åˆ©','ç™½ä¿„ç¾…æ–¯','æ¯”åˆ©æ™‚','æ³¢å£«å°¼äºèˆ‡èµ«å¡å“¥ç¶­ç´','ä¿åŠ åˆ©äº','å…‹ç¾…åŸƒè¥¿äº','æ·å…‹','ä¸¹éº¥','æ„›æ²™å°¼äº','æ³•ç¾…ç¾¤å³¶','èŠ¬è˜­','æ³•åœ‹','å¾·åœ‹','ç›´å¸ƒç¾…é™€','å¸Œè‡˜','æ ¹è¥¿å³¶','åŒˆç‰™åˆ©','å†°å³¶','æ„›çˆ¾è˜­','æ›¼å³¶','ç¾©å¤§åˆ©','æ¾¤è¥¿å³¶','æ‹‰è„«ç¶­äº','åˆ—æ”¯æ•¦æ–¯ç™»','ç«‹é™¶å®›','ç›§æ£®å ¡','åŒ—é¦¬å…¶é “','é¦¬çˆ¾ä»–','æ‘©çˆ¾å¤šç“¦','æ‘©ç´å“¥','è’™ç‰¹å…§å“¥ç¾…','è·è˜­','æŒªå¨','æ³¢è˜­','è‘¡è„ç‰™','ç¾…é¦¬å°¼äº','ä¿„ç¾…æ–¯','è–é¦¬åˆ©è«¾','å¡çˆ¾ç¶­äº','æ–¯æ´›ä¼å…‹','æ–¯æ´›ç¶­å°¼äº','è¥¿ç­ç‰™','æ–¯ç“¦å·´','ç‘å…¸','ç‘å£«','çƒå…‹è˜­','è‹±åœ‹','æ¢µè’‚å²¡','ç§‘ç´¢æ²ƒ','è¶æ–¯ç‰¹æ²³æ²¿','å®‰å‰æ‹‰','å®‰åœ°å¡åŠå·´å¸ƒé”','é˜¿é­¯å·´','å·´å“ˆé¦¬','å·´è²å¤š','è²é‡Œæ–¯','ç™¾æ…•é”','è‹±å±¬ç¶­äº¬ç¾¤å³¶','åŠ æ‹¿å¤§','é–‹æ›¼ç¾¤å³¶','å…‹åˆ©ç€é “å³¶','å“¥æ–¯å¤§é»åŠ ','å¤å·´','å¤æ‹‰ç´¢','å¤šç±³å°¼å…‹','å¤šæ˜å°¼åŠ ','è–©çˆ¾ç“¦å¤š','æ ¼é™µè˜­','æ ¼ç‘é‚£é”','ç“œå¾·ç¾…æ™®','ç“œåœ°é¦¬æ‹‰','æµ·åœ°','å®éƒ½æ‹‰æ–¯','ç‰™è²·åŠ ','é¦¬æå°¼å…‹å³¶','å¢¨è¥¿å“¥','è’™å“²è‡˜','ç´ç“¦è–©å³¶','å°¼åŠ æ‹‰ç“œ','å·´æ‹¿é¦¬','æ³¢å¤šé»å„','è–å·´æ³°å‹’ç±³','è–å…‹é‡Œæ–¯å¤šç¦åŠå°¼ç¶­æ–¯','è–éœ²è¥¿äº','æ³•å±¬è–é¦¬ä¸','è–çš®è€¶èˆ‡å¯†å…‹éš†ç¾¤å³¶','è–æ–‡æ£®åŠæ ¼ç‘é‚£ä¸','åƒé‡Œé”åŠæ‰˜å·´å“¥','åœŸå…‹å‡±å¯ç¾¤å³¶','ç¾åœ‹','ç¾å±¬ç¶­äº¬ç¾¤å³¶','è·å±¬è–é¦¬ä¸','æ³¢å…§èµ«','è–ä½‘é”ä¿®æ–¯','è·å±¬æ²™å·´','é˜¿æ ¹å»·','ç»åˆ©ç¶­äº','å·´è¥¿','æ™ºåˆ©','å“¥å€«æ¯”äº','å„ç“œå¤š','ç¦å…‹è˜­ç¾¤å³¶','æ³•å±¬åœ­äºé‚£','è“‹äºé‚£','å·´æ‹‰åœ­','ç§˜é­¯','è˜‡åˆ©å—','çƒæ‹‰åœ­','å§”å…§ç‘æ‹‰','ç¾å±¬è–©æ‘©äº','æ¾³å¤§åˆ©äº','è²å…‹ç¾¤å³¶','åº«å…‹ç¾¤å³¶','æ–æ¿Ÿ','æ³•å±¬ç»é‡Œå°¼è¥¿äº','é—œå³¶','è±ªè˜­å³¶','åŠ ç¶­æ–¯å³¶','å¼·æ–¯é “å³¶','é‡‘æ›¼ç¤','å‰é‡Œå·´æ–¯','é¦¬ç´¹çˆ¾ç¾¤å³¶','å¯†å…‹ç¾…å°¼è¥¿äº','ä¸­é€”å³¶','è«¾é­¯','æ–°å–€é‡Œå¤šå°¼äº','ç´è¥¿è˜­','ç´åŸƒ','è«¾ç¦å…‹å³¶','åŒ—é¦¬åˆ©å®‰ç´ç¾¤å³¶','å¸›ç‰','å¸•é‚æ‹‰ç’°ç¤','å·´å¸ƒäºç´å¹¾å…§äº','çš®ç‰¹è‚¯ç¾¤å³¶','è–©æ‘©äº','ç´¢ç¾…é–€ç¾¤å³¶','æ‰˜å…‹å‹','æ±åŠ ','åç“¦é­¯','è¬é‚£æœ','å¨å…‹å³¶','ç“¦åˆ©æ–¯å’Œå¯Œåœ–ç´å³¶','å¸ƒéŸ‹å³¶','æ³•å±¬å—éƒ¨é ˜åœ°','èµ«å¾·å³¶å’Œéº¥å…‹å”ç´ç¾¤å³¶','å—å–¬æ²»äºå³¶å’Œå—æ¡‘å¨å¥‡ç¾¤å³¶','å°ç£','å°å¼','ä¸­å¼','ç²µå¼','é–”å¼','å®¢å®¶','åŸä½æ°‘','ä¸Šæµ·','åŒ—äº¬','æ¸¯å¼','æ³°å¼','è¶Šå¼','å°å°¼','å¤§é¦¬','ç¾å¼','ç¾é™¸','è‹±å¼','æ­é™¸','æ—¥å¼','éŸ“å¼','å¤§éŸ“','æ³•å¼','ä¸­æ±']\n","level2_foodname =['æ¿ƒæ¹¯','èµ·å¸','è±†è‹—','è›‹å¡”','é±¸é­š','ç™½æ–¬é›','è±†èŠ±','éµæ¿ç‡’','ç‰›é›œ','é³³çˆª','æ°´é¤ƒ','ç‡’é›','è±†çš®','è›‹ç³•','å¥¶æ²¹','åƒå±¤','èœç“œ','ç”°èº','Taco','æ˜å¤ªå­','çƒé¾èŒ¶','éº¥èŒ¶','ç´…èŒ¶','ç¶ èŒ¶','æŠ¹èŒ¶','èŸ¹è‚‰','ç”œä¸è¾£','è±¬è‚‹æ’','é…’ç²¾','ç‰›èˆŒ','ç‚¸ç‰©','è›¤èœŠ','é­·é­š','çƒè³Š','é¤ƒå­','é±ˆé­š','ä¸¸å­','èƒèŸ¹','å£½å¸','å¤©å©¦ç¾…','ç¾Šæ’','ç« é­š','å¹²è²','å†¬ç²‰','ç‚’é£¯','é…¸èœ','ç”Ÿé­šç‰‡','é¥…é ­','é¦™è…¸','æä»','çŒ´é ­è‡','èŒ„å­','é«˜éº—èœ','æ´‹è”¥','é‡‘è','é¤›é£©','æµ·ç“œå­','pizza','é®­é­š','æ¾é˜ªè±¬','çƒ¤ä¸²','é’é†¬','åˆºè”¥','è˜‘è‡','çƒé¾éºµ','ç™½é£¯','ç«é›è‚‰é£¯','ç‰›è‚‰éºµ','æ»·è‚‰é£¯','ç‚•è‚‰é£¯','é´¨è‚‰é£¯','è¦ä»é£¯','è›‹ç‚’é£¯','ç«¹ç­’é£¯','æ’éª¨é£¯','æ–°ä¸ç²„','å°å¼é£¯ç³°','è™±ç›®é­š','è™±ç›®é­šè‚š','æµ®æ°´è™±ç›®é­šç¾¹','è™±ç›®é­šè‚šç²¥','éµè›‹','ç‰›è‚‰æ¹¯','é­šä¸¸æ¹¯','å››ç¥æ¹¯','ä¸‹æ°´æ¹¯','èœå°¾æ¹¯','é»‘ç™½åˆ‡','èšµä»”ç…','èšµä»”é…¥','é¹¹ç²¥','è‚‰ç¾¹','è¦ä»ç¾¹','èŠ±æç¾¹','ç¾Šè‚‰ç¾¹','è±†ç°½ç¾¹','å¤§éºµç¾¹','è¥¿é­¯è‚‰','è‚‰ç²½','é‡è–‘èŠ±ç²½','æ²¹é£¯','ç­’ä»”ç±³ç³•','æ²¹è”¥ç²¿','è±†èœéºµ','é—œå»Ÿéºµ','æ“”ä»”éºµ','èšŒéºµ','æ‘µä»”éºµ','é±”é­šæ„éºµ','é‹ç‡’æ„éºµ','ç‰é‡Œéºµ','ç²„æ¢','èµ¤ç‰›éºµ','è²“é¼ éºµ','å‚»ç“œä¹¾éºµ','èšµä»”éºµç·š','ç‚’ç±³ç²‰','ç±³ç²‰æ¹¯','ç±³è‹”ç›®','ç±³é¦™','æ¶¼åœ“','è‚‰åœ“','ç¢—ç²¿','æ‘©è¨¶ç²¿','éºµç²‰ç²¿','è²¢ä¸¸','è±¬è¡€ç³•','è¬å·’è±¬è…³','é¹¹é…¥é›','æ½¤é¤…','è¦é¤…','ç‚­çƒ¤ä¸‰æ˜æ²»','å°ç±³éº»ç³¬','ç•ªè–¯åœ“','å°ç£ç‡’ä»™è‰','èŠ‹é¥…é ­','çç ','å¥¶èŒ¶','æœ¨ç“œç‰›ä¹³','é’è›™ä¸‹è›‹','èŠ’æœå†°','è‡­è±†è…','æ·±å‘è±†è…','è±†ä¹³é›','é¹½æ°´é›','éº»æ²¹é›','è–‘æ¯é´¨','è—¥ç‡‰æ’éª¨','è—¥ç‡‰åœŸè™±','ç•¶æ­¸é´¨','æ±å±±é´¨é ­','è”¥æ²¹é¤…','æ»·å‘³','è‡­è‡­é‹','é¯Šé­šç…™','çƒ¤é¦™è…¸','å¤§é¤…åŒ…å°é¤…','å¤§è…¸åŒ…å°è…¸','åˆˆåŒ…','å’–å•¡é¦™è…¸','è†½è‚','éº»è¾£é´¨è¡€','é¦™é›æ’','æ²™æ‹‰èˆ¹','é­šé…¥','ç”˜æ¢…è–¯æ¢','ç‡’é…’èº','å¤§é›•ç‡’','çƒ¤é³¥è›‹','ç‚¸ğ©µšé­ é­š','ç‚¸æ£—','å¤§æºªè±†ä¹¾','é¦¬ç¥–é­šä¸¸','ç³¯ç±³è…¸','é›æ²','ç‹€å…ƒç³•','è²“æŒç‡’','ç³•æ¸£','çƒ¤é­·é­š','é‡Œæ¸¯æ‰é£Ÿ','æ°´ç…åŒ…','æ¹¯åœ“','æœˆé¤…','ç¶ è±†æ¤ª','è›‹é»ƒé…¥','å¤ªé™½é¤…','å·ç…','é¹¹é¤…','è”¥æŠ“é¤…','è”¥é¤…','è›‹é¤…','ç‰›èˆŒé¤…','å…±åŒªé¤…','è‚šè‡é¤…','èƒ¡aæ¤’é¤…','èºä»”é¤…','é»‘è²“åŒ…','é¼é‚Šè¶–','é¾é³³è…¿','èšµå—²','ç‚¸ç²¿','æ£ºææ¿','å¥®èµ·æ¹–ä¾¿ç•¶','è‡ºéµä¾¿ç•¶','æ± ä¸Šé£¯åŒ…','ç¦éš†ä¾¿ç•¶','ç„¢çª¯','è–‘æ±ç•ªèŒ„','éº»èŠ›','ä»™äººæŒå†°','é›è›‹å†°','èŠ±ç”Ÿå·åŠ å†°æ·‡æ·‹','åŒ…å¿ƒç²‰åœ“','è±†æ¼¿è±†èŠ±','æ„›ç‰','è±ä»å†°','å…«å¯¶å†¬ç²‰','è–‘æ±ç•ªèŒ„','æ·¡æ°´é˜¿çµ¦','ä¸‰æ¯','æ²¹è”¥é…¥','èœè„¯åµ','è¥¿è¡›éºµç·š','æ–°ç«¹ç±³ç²‰','èŠ‹åœ“','é»‘è¼ª','èœˆèš£èŸ³','é€šå¿ƒé°»','èœ‚å·¢é®®èšµ','è”­è±‰é®®èšµ','äº”æŸ³æé­š','ç´…èŸ³ç±³ç³•','æ«»èŠ±è¦ç±³ç³•','è—¥ç‡‰åœŸè™±','è™±ç›®é­šæ¹¯','è™±ç›®é­š','é­·é­šèºè‚‰è’œ','ä¹¾ç…ç™½é¯§','æ¸…è’¸çŸ³æ–‘','é­·é­šç¾¹','é¯Šé­šç…™','æ›¼æ³¢é­šçš®','ä¸‰æ¯é­šè…¸','è›‹é»ƒå¤§è¦','ç”˜è”—è¦','çƒ¤çƒé­šå­','ç³–é†‹é­š','é³³æ¢¨è¦çƒ','ä¸‰æ¯ç”°é›','ç´…ç‡’é­š','è±†ç“£é­š','è±†é…¥é­š','å®¢å®¶å°ç‚’','å¸ƒè¢‹é›','ç‡’é…’é›','ç”•ä»”é›','ç‹—å°¾é›','ä¸‰æ¯é›','è–‘æ¯é´¨','é³³æ¢¨è‹¦ç“œé›','å‰çš®è¾£æ¤’é›','é›ä»”è±¬è‚šé±‰','æ¶¼æ‹Œé´¨è³','çƒéª¨é›æ¹¯','ç”˜è”—é›','é›™ç·£ä½›æ‰‹','æ»·è±¬è…³','èŠ±ç”Ÿè±¬è…³','è¬å·’è±¬è…³','è±¬è…³éºµç·š','è—¥ç‡‰æ’éª¨','å¤§å°è‚‰','é†ƒè…¸ç†Ÿè‚‰','è–‘çµ²å¤§è…¸','å®¢å®¶å°ç‚’','ç´…ç³Ÿè‚‰','ç³–é†‹æ’éª¨','ç´…ç‡’æ’éª¨','è¥¿é­¯è‚‰','äº”è‰²å†·ç›¤','å’•å’¾è‚‰','è”¥çˆ†ç‰›è‚‰','è±†ä¹¾ç‰›è‚‰','ç‚’ç¾Šè‚‰','äº”æ›´è…¸æ—º','å®®ä¿çš®è›‹','èœè„¯è›‹','ä¹å±¤å¡”çƒ˜è›‹','ä¸‰è‰²è›‹','é¹¹è›‹è‹¦ç“œ','èŸ¹é»ƒè±†è…','éº»å©†è±†è…','è”¥ç‡’è±†è…','æµ·é®®è±†è…ç¾¹','éµæ¿è±†è…','è€çš®å«©è‚‰','ç«é‹','ç¾Šè‚‰çˆ','æµ·é®®é‹','éº»è¾£ç«é‹','é´›é´¦é‹','çŸ³é ­ç«é‹','ç´ é£Ÿé‹','ä½›è·³ç‰†','æ¡å£½å¸','å‘³å™Œæ¹¯','åˆºèº«','æ¸…é…’','ä¾¿ç•¶','ç´è±†','å¤©å©¦ç¾…','ç« é­šç‡’','ç«¹è¼ª','è•éº¥éºµ','ç‰›ä¸¼','æ‹‰éºµ','çƒé¾éºµ','æ‡·çŸ³æ–™ç†','é£¯','è›‹åŒ…é£¯','è–‘ç‡’è±¬è‚‰','é¦¬éˆ´è–¯ç‡‰è‚‰','æ¼¢å ¡æ’','æ—¥å¼ç‚¸é›å¡Š','é¤ƒå­','è±¬è‚‰æ¹¯','ç‚Šé£¯','é­šæ¿ä¸²','ç´«èœé£¯æ²','å†·éºµ','çƒ¤äº”èŠ±è‚‰','é†¬èŸ¹','æ˜¥å·ç‚’é›','è¡€è…¸','æ³¡èœ','éŸ“å¼æ‹Œé£¯','è¾£ç‚’å¹´ç³•','éŸ“å¼çƒ¤è‚‰','ç‚¸é†¬éºµ','äº”èŠ±è‚‰','ç‚¸é›','æ¼¢å ¡','æ¯”è–©','ç‰›æ’','å¢¨è¥¿å“¥æ²é¤…','çƒ¤è±¬è‚‹æ’','BBQ','å°åº¦çƒ¤é¤…','æ²é¤…','å’–å“©','å¥¶èŒ¶','å†°æ·‡æ·‹','æŠ“é£¯','é¬†é¤…','ç…é¤…','çƒ¤é¤…','çƒé¤…','ç‡’é¤…','è±Œè±†','è¾£é›è±†','æ˜è¦','èŒ„æ±å’–å“©é›','æ‹‰è¥¿','å„ªæ ¼','ç‚¸è”¬èœ','ç‰›è‚‰','é›è‚‰','ç¾Šè‚‰','é­šè‚‰','æµ·é®®','è±¬è‚‰','è èœ','é¦™èœ','èŠ¹èœ','è•¹èœ','èŒ¼è’¿','èŒ´é¦™','è§èœ','èµè‹£','æ²¹éº¥èœ','ç™½èœé¡','å°ç™½èœ','å¡Œæ£µèœ','èœå¿ƒ','å¤§ç™½èœ','æ²¹èœ','è–ºèœ','èŠ¥èœé¡','å­èŠ¥èœ','è•ªè','æ¦¨èœ','é›ªè£¡è•»','æ²¹èœ','ç”˜è—é¡','è‹¤è—','é’èŠ±èœ','èŠ±æ¤°èœ','å¯¶å¡”èŠ±èœ','æ²å¿ƒèœ','æŠ±å­ç”˜è—','ç´«ç”˜è—','ç¾½è¡£ç”˜è—','æœ¨ç«‹èŠ±æ¤°èœ','ç™½èŠ±èŠ¥è—','èŠ¥è—','æ°´ç”Ÿé¡','è¥¿æ´‹èœ','æ°´èŠ¹','å¤§è”¥','å°è”¥','ç«è”¥','æ¨“å­è”¥','å¤§è’œ','æ´‹è”¥','éŸ­èœ','éŸ­è”¥','è–¤','è–èœé¡','å¤§é»ƒ','è˜†ç­','ç”˜è”—','ç­Šç™½ç­','ç“œæœé¡','é»ƒç“œ','çµ²ç“œ','å†¬ç“œ','è‹¦ç“œ','å—ç“œ','è¥¿è‘«è˜†','è‘«è˜†','ç­ç“œ','ä½›æ‰‹ç“œ','èŒ„å­','ç•ªèŒ„','è¾£æ¤’','èœæ¤’','æ ¹è–é¡','ç•ªè–¯','é¦¬éˆ´è–¯','å±±è—¥','èŠ‹é ­','é­”èŠ‹','è–‘','ç™½è˜¿è””','èƒ¡è˜¿è””','è¾£æ ¹','ç”œèœæ ¹','èŠ¹èœæ ¹','æœ¨è–¯','æ¨¹è–¯','é›ªè“®è–¯','è±†é¡','ç´…è±†','è±Œè±†','åˆ€è±†','è ¶è±†','å¤§è±†','è±†è§’','è±‡è±†','æ‰è±†','å››å­£è±†','è·åŒ…è±†','æ¯›è±†','è“®è—•','èŒ­ç™½','è±è§’','è“´èœ','æ…ˆè‡','æ°´èŠ¹','èŠ¡å¯¦','è’²èœ','é¾éª¨ç“£','è•èœ','çµäººç‡´é›','ç¾©å¤§åˆ©è–„é¤…','ç¾©å¤§åˆ©éºµ','ç¾©å¤§åˆ©é¤ƒ','æ„å¼å†°æ·‡æ·‹','ææ‹‰ç±³è˜‡','å¡å¸ƒå¥‡è«¾','æ¿ƒç¸®å’–å•¡','æ‹¿éµå’–å•¡','ç‰¹è‰²é£Ÿå“','æ¾éœ²èŒ','å·´é¦¬è‡£èµ·å¸','è«è–©é‡Œæ‹‰èµ·å¸','é¦¬æ–¯å¡å½­èµ·å¸','å¡è˜‡é¦¬è˜‡ä¹³é…ª','å·´é¦¬ç«è…¿','èæ¨‚ç¾è…¸','æ„å¼è‚‰è…¸','é¢¨ä¹¾è±¬é¢é °è‚‰','é¦™è’œé†¬','ç†±é‚£äºé†¬','è•ƒèŒ„è‚‰é†¬','è¾£è¦æ¹¯','é’æœ¨ç“œ','é›æ¹¯','ç´…å’–å“©','æ³°å¼ç‚’é£¯','æ‰“æ‹‹è±¬è‚‰','ç¶ å’–å“©','æ‰“æ‹‹è±¬','æœˆäº®è¦é¤…','æ²³ç²‰','è¦é†¬','è¦çƒ','æ²™æ‹‰','æ˜¥æ²','ç±³ç·š','è…¸ç²‰','é¦™èŒ…','é­šéœ²','æ³•åœ‹è¸ç‰›','é’è›™è…¿','è‚¥è‚','æ¾éœ²','é­šå­é†¬','ç´…é…’ç‡‰ç‰›è‚‰','å­›è‰®åœ°ç‡‰ç‰›è‚‰','ç«ä¸Šé‹','ç‡‰èœé‹','è”¬èœç‡‰ç‰›è‚‰','ç™½é†¬ç‡‰ç‰›è‚‰','ç‡‰ç‰›è‚‰ä½ç™½é†¬','è€å¥¶å¥¶ç‰›è‚‰','éŸƒé¼ç”Ÿç‰›å¡”','é‡è »äººç‰›è‚‰','è«¾æ›¼åœ°ç‰›è‚šé‹','é•·æ£éºµåŒ…','å¯é ŒéºµåŒ…','å¸ƒè‰æ­','å·§å…‹åŠ›','ç«è…¿èµ·å¸ä¸‰æ˜æ²»','å¯éº—é¤…','é¹¹æ´¾','è˜‹æœæ´¾','è–¯æ¢','ç”Ÿè ”','é¾è¦','æ™®ç¾…æ—ºæ–¯ç‡‰èœ','é¦¬éˆ´è–¯æ³¥','æ­å§†è›‹','èµ·å¸ç«é‹','ç´…é…’','è‘¡è„é…’å‡','é¦¬è³½é­šæ¹¯','ç„—çƒ¤æ´‹è”¥æ¹¯','è˜‘è‡æ¿ƒæ¹¯','é¦¬å¡é¾','æª¸æª¬å¡”','ç¿»è½‰è˜‹æœå¡”','é–ƒé›»æ³¡èŠ™','ä¿®å¥³æ³¡èŠ™','æ…•çµ²','å·§å…‹åŠ›','ç†”å²©å·§å…‹åŠ›','ç„¦ç³–å¸ƒ','å¥¶æ²¹çƒ¤å¸ƒè•¾','å¥¶æ²¹é…¥','æ³•å¼åƒå±¤é…¥','æ³•å¼æ£‰èŠ±ç³–','èˆ’èŠ™è•¾','å¯éº—éœ²','æ‰‹æŒ‡é¤…ä¹¾','è²»å—é›ª','è’™å¸ƒæœ—','æ —å­è›‹ç³•','ç‘ªå¾·è“®','ç´…é…’','ç™½é…’','å•¤é…’','èª¿é…’','æ°´æœé…’','ç´¹èˆˆ','åˆ©å£é…’','æ°£æ³¡é…’','ä¸­è—¥','ç™½è˜­åœ°','è‘¡è„æŸš','è˜‹æœ','æ¢¨å­','é‡‘æŸ‘','é³³æ¢¨','è‰è“','æ¡¶æŸ‘','è“®éœ§','æ¤ªæŸ‘','æŸšå­','é‡‹è¿¦','é¾çœ¼','é¦™è•‰','æœ¨ç“œ','æŸ‘æ©˜','æ«»æ¡ƒ','èŠ’æœ','æ¥Šæ¡ƒ','æŸ³ä¸','è‘¡è„','è‘¡è„','é¦™ç“œ','è”æ','é³³æ¢¨','æŸšå­','ç«é¾æœ','è¥¿ç“œ','æ¦´æ§¤','èŠ’æœ','è‰è“','æ¥Šæ¡ƒ','æœ¨ç“œ','é¾çœ¼','ç”œæŸ¿','è“®éœ§','é‡‹è¿¦','é¦™è•‰','æŸ¿å­','è”æ','ç•ªçŸ³æ¦´','è‘¡è„','æŸšå­','é³³æ¢¨','è‰è“']\n","level3_taste =['æŸ”è»Ÿ','ç¶¿æ»‘','è¥¿è¥¿é‡Œ','é…¥è„†','é†‹æºœ','é¦™ç”œ','å¯å£','è„†æ»‘','æ™¶ç‘©','é¬†è»Ÿ','è‚¥ç¾','é¦™ç”œ','æ½¤æ»‘','é®®é»ƒ','æ»‹æ½¤','å„ªè³ª','é®®ç”œ','ç¾å‘³','ç™½æ·¨','æŸ”æš–','è»Ÿç³¯','ç³¯é¦™','é’é†¬','ç™½é†¬','éº»è¾£','ç²‰ç´…é†¬','ç´…é†¬','å·´æ–¯å…‹','èè','èæœ—','æ·¡ç”œ','ç´…ç‡’','æ¸…ç‡‰','èª˜äºº','ç²¾ç·»','ç´°è†©','é¦™æ»‘','é¦™æ–™','','é…¸','ç”œ','è‹¦','è¾£','é¹¹','è”¥','è–‘','è’œ','æ´‹è”¥','å±±æŸ°','èŠ¹èœ','é¦™èŠ¹','è¾£æ¤’','èŠ±æ¤’','èƒ¡æ¤’','é»‘èƒ¡æ¤’','ç™½èƒ¡æ¤’','ç´…èƒ¡æ¤’','ä¸é¦™','è‚‰æ¡‚','ä¸­åœ‹è‚‰æ¡‚','ç™¾é‡Œé¦™','è¿·è¿­é¦™','å¤§èŒ´é¦™å­','å°èŒ´é¦™å­','è’”è˜¿','å…«è§’','å­œç„¶','è‘›ç¸·å­','è–‘é»ƒ','èŠ¥æœ«','å±±è‘µ','è¾£æ ¹','è—ç´…èŠ±','é¦™è‰','æœˆæ¡‚','æ¢”å­','ç¾…å‹’','é¾è’¿','ç‰›è‡³','é¦™èŒ…','é¢¨è¼ªèœ','é¼ å°¾è‰','ç‰›è†è‰','è–°è¡£è‰','æ¾éœ²','é»‘æ¾éœ²','ç™½æ¾éœ²','é¦™è¾£æ¤’','èƒ­è„‚æ¨¹ç±½','æœˆæ¡‚è‘‰','é»‘ç¨®è‰','é…¸ç“œéˆ•','èŠ¹èœç±½','èŠ«è½','å’–å“©è‘‰','è‘«è˜†å·´','å¤©å ‚æ¤’','æœæ¾å­','èŠ¥èœç±½','è‚‰è±†è”»','ç”œæ¤’','çŸ³æ¦´ç±½','ç½Œç²Ÿç±½','é¹½','ç²¾è£½é¹½','èŠéº»','é…¸æ¨¡','é…¸å­','ç¾…å‹’','ä½›æ‰‹æŸ‘','é¦™èœ','è¥¿æ´‹èœ','è’²å…¬è‹±','è’”è˜¿','é¦™èŒ…','è–„è·','èŠ¥å­','é¦™èŠ¹','è¿·è¿­é¦™','è—¥ç”¨é¼ å°¾è‰','é¦™è¾£è“¼','ä¸ƒè‘‰è˜­','ç•ªç´…èŠ±','ç¢ŒæŸšè‘‰','ä¹å±¤å¡”','èŠ«èŒœ','æ–‘è˜­è‘‰']"],"metadata":{"id":"pny15zybFjcl","executionInfo":{"status":"ok","timestamp":1712824522264,"user_tz":-480,"elapsed":765,"user":{"displayName":"ç‹æ™´","userId":"13545761289751374787"}}},"execution_count":2,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"KkN2jQTJfSkA"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["print(len(level1_country))\n","print(len(level2_foodname))\n","print(len(level3_taste))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"eliY3thMFlDx","executionInfo":{"status":"ok","timestamp":1712133177181,"user_tz":-480,"elapsed":4,"user":{"displayName":"ç‹æ™´","userId":"13545761289751374787"}},"outputId":"65e6ba2e-864e-40e1-ed3a-80d625cc7e88"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["288\n","557\n","113\n"]}]},{"cell_type":"code","source":["dtype = {'user_ratings_total': float, 'editorial_summary': str, 'keywords': str, 'keywords_processed': str}\n","df = dd.read_csv('/content/restaurant_data_output_merge_ewe.csv', dtype=dtype)\n","df['user_ratings_total'] = df['user_ratings_total'].fillna(0).astype('int64')\n","df['user_ratings_total'] = df['user_ratings_total'].astype('Int64')\n"],"metadata":{"id":"woHCeqs7OH_g","executionInfo":{"status":"error","timestamp":1712824522265,"user_tz":-480,"elapsed":7,"user":{"displayName":"ç‹æ™´","userId":"13545761289751374787"}},"colab":{"base_uri":"https://localhost:8080/","height":473},"outputId":"1d9ed383-35a2-45ee-f657-ff4ed7aef20e"},"execution_count":3,"outputs":[{"output_type":"error","ename":"FileNotFoundError","evalue":"An error occurred while calling the read_csv method registered to the pandas backend.\nOriginal Message: [Errno 2] No such file or directory: '/gdrive/Shareddrives/å¾è³‡æ–™å­¸ç¿’2/Dataset & code/clean/restaurant_data_output_merge_ewe.csv'","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mFileNotFoundError\u001b[0m                         Traceback (most recent call last)","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/dask/backends.py\u001b[0m in \u001b[0;36mwrapper\u001b[0;34m(*args, **kwargs)\u001b[0m\n\u001b[1;32m    135\u001b[0m                 \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 136\u001b[0;31m                     \u001b[0;32mreturn\u001b[0m \u001b[0mfunc\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    137\u001b[0m                 \u001b[0;32mexcept\u001b[0m \u001b[0mException\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/dask/dataframe/io/csv.py\u001b[0m in \u001b[0;36mread\u001b[0;34m(urlpath, blocksize, lineterminator, compression, sample, sample_rows, enforce, assume_missing, storage_options, include_path_column, **kwargs)\u001b[0m\n\u001b[1;32m    760\u001b[0m     ):\n\u001b[0;32m--> 761\u001b[0;31m         return read_pandas(\n\u001b[0m\u001b[1;32m    762\u001b[0m             \u001b[0mreader\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/dask/dataframe/io/csv.py\u001b[0m in \u001b[0;36mread_pandas\u001b[0;34m(reader, urlpath, blocksize, lineterminator, compression, sample, sample_rows, enforce, assume_missing, storage_options, include_path_column, **kwargs)\u001b[0m\n\u001b[1;32m    560\u001b[0m     \u001b[0mb_lineterminator\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mlineterminator\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mencode\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 561\u001b[0;31m     b_out = read_bytes(\n\u001b[0m\u001b[1;32m    562\u001b[0m         \u001b[0murlpath\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/dask/bytes/core.py\u001b[0m in \u001b[0;36mread_bytes\u001b[0;34m(urlpath, delimiter, not_zero, blocksize, sample, compression, include_path, **kwargs)\u001b[0m\n\u001b[1;32m    110\u001b[0m                 )\n\u001b[0;32m--> 111\u001b[0;31m             \u001b[0msize\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mfs\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0minfo\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mpath\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m\"size\"\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    112\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0msize\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/fsspec/implementations/local.py\u001b[0m in \u001b[0;36minfo\u001b[0;34m(self, path, **kwargs)\u001b[0m\n\u001b[1;32m     86\u001b[0m             \u001b[0mpath\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_strip_protocol\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mpath\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 87\u001b[0;31m             \u001b[0mout\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mos\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstat\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mpath\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mfollow_symlinks\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mFalse\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     88\u001b[0m             \u001b[0mlink\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mstat\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mS_ISLNK\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mout\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mst_mode\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mFileNotFoundError\u001b[0m: [Errno 2] No such file or directory: '/gdrive/Shareddrives/å¾è³‡æ–™å­¸ç¿’2/Dataset & code/clean/restaurant_data_output_merge_ewe.csv'","\nThe above exception was the direct cause of the following exception:\n","\u001b[0;31mFileNotFoundError\u001b[0m                         Traceback (most recent call last)","\u001b[0;32m<ipython-input-3-fa57fbb1aa33>\u001b[0m in \u001b[0;36m<cell line: 2>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0mdtype\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m{\u001b[0m\u001b[0;34m'user_ratings_total'\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mfloat\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'editorial_summary'\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mstr\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'keywords'\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mstr\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'keywords_processed'\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mstr\u001b[0m\u001b[0;34m}\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 2\u001b[0;31m \u001b[0mdf\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mdd\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mread_csv\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'/gdrive/Shareddrives/å¾è³‡æ–™å­¸ç¿’2/Dataset & code/clean/restaurant_data_output_merge_ewe.csv'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdtype\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mdtype\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      3\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      4\u001b[0m \u001b[0mdf_tour\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mdd\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mread_csv\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'/gdrive/Shareddrives/å¾è³‡æ–™å­¸ç¿’2/Dataset & code/clean/tour_data_output_merge_ewe.csv'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdtype\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mdtype\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      5\u001b[0m \u001b[0mdf_tour\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'user_ratings_total'\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mdf_tour\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'user_ratings_total'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfillna\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mastype\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'int64'\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/dask/backends.py\u001b[0m in \u001b[0;36mwrapper\u001b[0;34m(*args, **kwargs)\u001b[0m\n\u001b[1;32m    136\u001b[0m                     \u001b[0;32mreturn\u001b[0m \u001b[0mfunc\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    137\u001b[0m                 \u001b[0;32mexcept\u001b[0m \u001b[0mException\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 138\u001b[0;31m                     raise type(e)(\n\u001b[0m\u001b[1;32m    139\u001b[0m                         \u001b[0;34mf\"An error occurred while calling the {funcname(func)} \"\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    140\u001b[0m                         \u001b[0;34mf\"method registered to the {self.backend} backend.\\n\"\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mFileNotFoundError\u001b[0m: An error occurred while calling the read_csv method registered to the pandas backend.\nOriginal Message: [Errno 2] No such file or directory: '/gdrive/Shareddrives/å¾è³‡æ–™å­¸ç¿’2/Dataset & code/clean/restaurant_data_output_merge_ewe.csv'"]}]},{"cell_type":"code","source":["def contains_empty_list(lst):\n","    return lst == []\n","df = df[df['keywords'].apply(lambda x: x != '[]')]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":180},"id":"miyWrtUPLzQV","executionInfo":{"status":"error","timestamp":1712824580081,"user_tz":-480,"elapsed":327,"user":{"displayName":"ç‹æ™´","userId":"13545761289751374787"}},"outputId":"25e008e4-8556-4c7b-b6e4-0bb20f606097"},"execution_count":4,"outputs":[{"output_type":"error","ename":"NameError","evalue":"name 'df' is not defined","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","\u001b[0;32m<ipython-input-4-1c6600f1c292>\u001b[0m in \u001b[0;36m<cell line: 3>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0;32mdef\u001b[0m \u001b[0mcontains_empty_list\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mlst\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      2\u001b[0m     \u001b[0;32mreturn\u001b[0m \u001b[0mlst\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 3\u001b[0;31m \u001b[0mdf\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mdf\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mdf\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'keywords'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mapply\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;32mlambda\u001b[0m \u001b[0mx\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mx\u001b[0m \u001b[0;34m!=\u001b[0m \u001b[0;34m'[]'\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;31mNameError\u001b[0m: name 'df' is not defined"]}]},{"cell_type":"code","source":["def process_keywords(keywords_str):\n","    if isinstance(keywords_str, str):\n","        # Remove '[' and ']' characters from the string\n","        keywords_str = keywords_str.replace('[', '').replace(']', '')\n","        keywords_list = keywords_str.split(',')\n","        # Strip leading and trailing spaces from each keyword\n","        keywords_list = [keyword.strip() for keyword in keywords_list]\n","        # Enclose each keyword in single quotes and join them with commas\n","        return ', '.join([f\"'{keyword}'\" for keyword in keywords_list])\n","    else:\n","        return ''\n","\n","# Apply the process_keywords function to the 'keywords' column\n","df['keywords_processed'] = df['keywords'].apply(process_keywords, meta=('object'))\n","\n","# Display the first few rows of the DataFrame with the processed keywords\n","df.head()\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":898},"id":"po-Xdn9gQ_-6","executionInfo":{"status":"ok","timestamp":1712340160142,"user_tz":-480,"elapsed":1044,"user":{"displayName":"ç‹æ™´","userId":"13545761289751374787"}},"outputId":"f95b27f3-e569-4e7b-835e-d5e9553dca0b"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.10/dist-packages/dask/dataframe/core.py:7084: FutureWarning: Meta is not valid, `map_partitions` and `map_overlap` expects output to be a pandas object. Try passing a pandas object as meta or a dict or tuple representing the (name, dtype) of the columns. In the future the meta you passed will not work.\n","  warnings.warn(\n"]},{"output_type":"execute_result","data":{"text/plain":["                      place_id  \\\n","0  ChIJaU_-FyqrQjQRbLmzDXFaj5E   \n","1  ChIJJXnO0barQjQR0ZJz1JGJ8v4   \n","2  ChIJA35dJHyrQjQRJ-sD3kSwWUY   \n","3  ChIJ21GPVhKsQjQRO3C5Xb-roFY   \n","4  ChIJy0NrQeSrQjQRVlv2fBcHVEA   \n","\n","                                                name business_status  \\\n","0                                          é¦¬å‹å‹å°åº¦æ¸…çœŸé¤å»³     OPERATIONAL   \n","1                                      é¦¬å‹å‹å°åº¦é¤å»³é…’å§+æ°´ç…™é¤¨     OPERATIONAL   \n","2  Mellow Bar & Restaurant-æ±å€ç²¾é‡€å•¤é…’|èšé¤é¤å»³|å¿…åƒé¤é…’é¤¨|ç¶²ç¾é¤é…’...     OPERATIONAL   \n","3                                       æ˜ŸæœŸäº”ç¾å¼é¤å»³ï¼ˆç¾éº—è¯ï¼‰     OPERATIONAL   \n","4                                          éå¸¸æ³° - å¾©èˆˆåº—     OPERATIONAL   \n","\n","  wheelchair_accessible_entrance  \\\n","0                           True   \n","1                           True   \n","2                           <NA>   \n","3                           True   \n","4                          False   \n","\n","                                                type  rating  \\\n","0  ['restaurant', 'point_of_interest', 'food', 'e...     4.7   \n","1  ['bar', 'restaurant', 'food', 'point_of_intere...     4.7   \n","2  ['restaurant', 'point_of_interest', 'food', 'e...     4.9   \n","3  ['restaurant', 'food', 'point_of_interest', 'e...     4.1   \n","4  ['restaurant', 'food', 'point_of_interest', 'e...     4.4   \n","\n","                                   editorial_summary  user_ratings_total  \\\n","0  {'language': 'zh-TW', 'overview': 'æ¸…çœŸèªè­‰çš„ä¼‘é–’é¤å»³ï¼Œæ...              2091.0   \n","1  {'language': 'zh-TW', 'overview': 'ä¾›æ‡‰å°åº¦èˆ‡ä¸­å¼é¤é»çš„æ–°...              2125.0   \n","2                                               <NA>               518.0   \n","3  {'language': 'zh-TW', 'overview': 'æ°£æ°›æ­¡æ¨‚çš„é€£é–ä¼‘é–’é¤å»³...              2401.0   \n","4                                               <NA>              1546.0   \n","\n","   price_level formatted_phone_number  ... delivery  \\\n","0          2.0           02 2711 2067  ...     True   \n","1          NaN           02 2500 6186  ...     True   \n","2          NaN           02 2771 9907  ...    False   \n","3          NaN           02 2175 3358  ...     True   \n","4          2.0           02 2546 6745  ...     True   \n","\n","                                location(lat,lng)  \\\n","0  {'lat': 25.04102259999999, 'lng': 121.5497197}   \n","1         {'lat': 25.0458202, 'lng': 121.5332625}   \n","2         {'lat': 25.0397848, 'lng': 121.5522774}   \n","3         {'lat': 25.0836081, 'lng': 121.5572275}   \n","4         {'lat': 25.0591667, 'lng': 121.5444444}   \n","\n","                                        reviews_text  serves_breakfast  \\\n","0  ['ç”œé»éå¸¸ä¸æ¨è–¦ å¤ªç”œäº† ä¸çŸ¥é“åœ¨åƒä»€éº¼æ±è¥¿çš„ç”œé» çƒ¤é¤…è·Ÿè…°æœé›å’–å“©é‚„ä¸éŒ¯ ä½†æˆ‘ä¸å–œæ­¡åº—å“¡...             False   \n","1  ['å’–å–±å£å‘³å¤šå…ƒï¼Œå¥¶æ²¹ã€è èœã€é¦™æ–™å’–å–±\\næœ‰ç¾Šè‚‰ã€é›ã€æµ·é®®ã€ä¹³é…ªé…æ–™\\n\\næ¨è–¦ğŸŒŸå¦ç£ç¢³çƒ¤å„ª...              <NA>   \n","2  ['å¿ å­æ•¦åŒ–ç«™æ˜æ›œç™¾è²¨é€™å€‹å‡ºå£å¾216å··é€²ä¾†\\nå¾ˆå®¹æ˜“æ‰¾åˆ°ï¼Œé¤é»å°šå¯ï¼Œè«‡ä¸ä¸Šç¾å‘³ä½³é¤šï¼Œé…é…’èœ...              <NA>   \n","3  ['äººå‡ä¸€åƒå¡Šå°±èƒ½åƒåˆ°éå¸¸è±ç››çš„é¤å»³\\n\\nè±¬è‚‹æ’é‚„æ˜¯ç”¨ç”°ç´è¥¿å¨å£«å¿Œç‡’çƒ¤é†¬æ­é…æœ€æ£’\\né€™å€‹é†¬...              <NA>   \n","4  ['\\\\ç“¦åŸæ——ä¸‹æ™‚å°šåˆé£Ÿå°šçš„æ³°å¼é¤å»³ï¼/\\n\\nğŸ‘ğŸ¼ç™½é£¯åƒåˆ°é£½\\nğŸ‘ğŸ¼é£²æ–™è¶…å¥½å–\\nğŸ‘ğŸ¼ç”¨é¤...             False   \n","\n","  serves_brunch serves_lunch serves_dinner serves_vegetarian_food  \\\n","0         False         True          True                   True   \n","1         False         True          True                   True   \n","2          <NA>         <NA>          True                   <NA>   \n","3          <NA>         True          True                   <NA>   \n","4         False         True          True                   <NA>   \n","\n","                                            keywords  \\\n","0  ['å’–å“©', 'çƒ¤é¤…', 'éå¸¸', 'ç”œé»', 'æ¨è–¦', 'åº—å“¡', 'å£å‘³', 'çƒ¤ç‰›...   \n","1  ['é¦™æ–™', 'å’–å–±', 'é›è‚‰', 'çƒ¤é¤…', 'é¢¨æ ¼', 'å’–å“©', 'è‚šçš®èˆ', 'å‘³...   \n","2  ['é¤é»', 'æ„Ÿè¦º', 'å¥½å–', 'é¤é…’é¤¨', 'ä¸é', 'ç¾å¼', 'æœ‰é»', 'èª¿...   \n","3  ['èµ·å¸', 'æ²™æ‹‰', 'é€™å€‹', 'æ¿ƒæ¹¯', 'ç‰›æ’', 'æ­é…', 'è•ƒèŒ„', 'è±¬è‚‹...   \n","4  ['ç”¨é¤', 'æ³°å¼', 'è¶…ç´š', 'è¦é¤…', 'æ™‚é–“', 'é¸æ“‡', 'é¤é»', 'ä¸é...   \n","\n","                                  keywords_processed  \n","0  ''å’–å“©'', ''çƒ¤é¤…'', ''éå¸¸'', ''ç”œé»'', ''æ¨è–¦'', ''åº—å“¡''...  \n","1  ''é¦™æ–™'', ''å’–å–±'', ''é›è‚‰'', ''çƒ¤é¤…'', ''é¢¨æ ¼'', ''å’–å“©''...  \n","2  ''é¤é»'', ''æ„Ÿè¦º'', ''å¥½å–'', ''é¤é…’é¤¨'', ''ä¸é'', ''ç¾å¼'...  \n","3  ''èµ·å¸'', ''æ²™æ‹‰'', ''é€™å€‹'', ''æ¿ƒæ¹¯'', ''ç‰›æ’'', ''æ­é…''...  \n","4  ''ç”¨é¤'', ''æ³°å¼'', ''è¶…ç´š'', ''è¦é¤…'', ''æ™‚é–“'', ''é¸æ“‡''...  \n","\n","[5 rows x 23 columns]"],"text/html":["\n","  <div id=\"df-a815de79-f258-4a1e-87d1-3909c50a823c\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>place_id</th>\n","      <th>name</th>\n","      <th>business_status</th>\n","      <th>wheelchair_accessible_entrance</th>\n","      <th>type</th>\n","      <th>rating</th>\n","      <th>editorial_summary</th>\n","      <th>user_ratings_total</th>\n","      <th>price_level</th>\n","      <th>formatted_phone_number</th>\n","      <th>...</th>\n","      <th>delivery</th>\n","      <th>location(lat,lng)</th>\n","      <th>reviews_text</th>\n","      <th>serves_breakfast</th>\n","      <th>serves_brunch</th>\n","      <th>serves_lunch</th>\n","      <th>serves_dinner</th>\n","      <th>serves_vegetarian_food</th>\n","      <th>keywords</th>\n","      <th>keywords_processed</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>ChIJaU_-FyqrQjQRbLmzDXFaj5E</td>\n","      <td>é¦¬å‹å‹å°åº¦æ¸…çœŸé¤å»³</td>\n","      <td>OPERATIONAL</td>\n","      <td>True</td>\n","      <td>['restaurant', 'point_of_interest', 'food', 'e...</td>\n","      <td>4.7</td>\n","      <td>{'language': 'zh-TW', 'overview': 'æ¸…çœŸèªè­‰çš„ä¼‘é–’é¤å»³ï¼Œæ...</td>\n","      <td>2091.0</td>\n","      <td>2.0</td>\n","      <td>02 2711 2067</td>\n","      <td>...</td>\n","      <td>True</td>\n","      <td>{'lat': 25.04102259999999, 'lng': 121.5497197}</td>\n","      <td>['ç”œé»éå¸¸ä¸æ¨è–¦ å¤ªç”œäº† ä¸çŸ¥é“åœ¨åƒä»€éº¼æ±è¥¿çš„ç”œé» çƒ¤é¤…è·Ÿè…°æœé›å’–å“©é‚„ä¸éŒ¯ ä½†æˆ‘ä¸å–œæ­¡åº—å“¡...</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>True</td>\n","      <td>True</td>\n","      <td>True</td>\n","      <td>['å’–å“©', 'çƒ¤é¤…', 'éå¸¸', 'ç”œé»', 'æ¨è–¦', 'åº—å“¡', 'å£å‘³', 'çƒ¤ç‰›...</td>\n","      <td>''å’–å“©'', ''çƒ¤é¤…'', ''éå¸¸'', ''ç”œé»'', ''æ¨è–¦'', ''åº—å“¡''...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>ChIJJXnO0barQjQR0ZJz1JGJ8v4</td>\n","      <td>é¦¬å‹å‹å°åº¦é¤å»³é…’å§+æ°´ç…™é¤¨</td>\n","      <td>OPERATIONAL</td>\n","      <td>True</td>\n","      <td>['bar', 'restaurant', 'food', 'point_of_intere...</td>\n","      <td>4.7</td>\n","      <td>{'language': 'zh-TW', 'overview': 'ä¾›æ‡‰å°åº¦èˆ‡ä¸­å¼é¤é»çš„æ–°...</td>\n","      <td>2125.0</td>\n","      <td>NaN</td>\n","      <td>02 2500 6186</td>\n","      <td>...</td>\n","      <td>True</td>\n","      <td>{'lat': 25.0458202, 'lng': 121.5332625}</td>\n","      <td>['å’–å–±å£å‘³å¤šå…ƒï¼Œå¥¶æ²¹ã€è èœã€é¦™æ–™å’–å–±\\næœ‰ç¾Šè‚‰ã€é›ã€æµ·é®®ã€ä¹³é…ªé…æ–™\\n\\næ¨è–¦ğŸŒŸå¦ç£ç¢³çƒ¤å„ª...</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>False</td>\n","      <td>True</td>\n","      <td>True</td>\n","      <td>True</td>\n","      <td>['é¦™æ–™', 'å’–å–±', 'é›è‚‰', 'çƒ¤é¤…', 'é¢¨æ ¼', 'å’–å“©', 'è‚šçš®èˆ', 'å‘³...</td>\n","      <td>''é¦™æ–™'', ''å’–å–±'', ''é›è‚‰'', ''çƒ¤é¤…'', ''é¢¨æ ¼'', ''å’–å“©''...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>ChIJA35dJHyrQjQRJ-sD3kSwWUY</td>\n","      <td>Mellow Bar &amp; Restaurant-æ±å€ç²¾é‡€å•¤é…’|èšé¤é¤å»³|å¿…åƒé¤é…’é¤¨|ç¶²ç¾é¤é…’...</td>\n","      <td>OPERATIONAL</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>['restaurant', 'point_of_interest', 'food', 'e...</td>\n","      <td>4.9</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>518.0</td>\n","      <td>NaN</td>\n","      <td>02 2771 9907</td>\n","      <td>...</td>\n","      <td>False</td>\n","      <td>{'lat': 25.0397848, 'lng': 121.5522774}</td>\n","      <td>['å¿ å­æ•¦åŒ–ç«™æ˜æ›œç™¾è²¨é€™å€‹å‡ºå£å¾216å··é€²ä¾†\\nå¾ˆå®¹æ˜“æ‰¾åˆ°ï¼Œé¤é»å°šå¯ï¼Œè«‡ä¸ä¸Šç¾å‘³ä½³é¤šï¼Œé…é…’èœ...</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>True</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>['é¤é»', 'æ„Ÿè¦º', 'å¥½å–', 'é¤é…’é¤¨', 'ä¸é', 'ç¾å¼', 'æœ‰é»', 'èª¿...</td>\n","      <td>''é¤é»'', ''æ„Ÿè¦º'', ''å¥½å–'', ''é¤é…’é¤¨'', ''ä¸é'', ''ç¾å¼'...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>ChIJ21GPVhKsQjQRO3C5Xb-roFY</td>\n","      <td>æ˜ŸæœŸäº”ç¾å¼é¤å»³ï¼ˆç¾éº—è¯ï¼‰</td>\n","      <td>OPERATIONAL</td>\n","      <td>True</td>\n","      <td>['restaurant', 'food', 'point_of_interest', 'e...</td>\n","      <td>4.1</td>\n","      <td>{'language': 'zh-TW', 'overview': 'æ°£æ°›æ­¡æ¨‚çš„é€£é–ä¼‘é–’é¤å»³...</td>\n","      <td>2401.0</td>\n","      <td>NaN</td>\n","      <td>02 2175 3358</td>\n","      <td>...</td>\n","      <td>True</td>\n","      <td>{'lat': 25.0836081, 'lng': 121.5572275}</td>\n","      <td>['äººå‡ä¸€åƒå¡Šå°±èƒ½åƒåˆ°éå¸¸è±ç››çš„é¤å»³\\n\\nè±¬è‚‹æ’é‚„æ˜¯ç”¨ç”°ç´è¥¿å¨å£«å¿Œç‡’çƒ¤é†¬æ­é…æœ€æ£’\\né€™å€‹é†¬...</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>True</td>\n","      <td>True</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>['èµ·å¸', 'æ²™æ‹‰', 'é€™å€‹', 'æ¿ƒæ¹¯', 'ç‰›æ’', 'æ­é…', 'è•ƒèŒ„', 'è±¬è‚‹...</td>\n","      <td>''èµ·å¸'', ''æ²™æ‹‰'', ''é€™å€‹'', ''æ¿ƒæ¹¯'', ''ç‰›æ’'', ''æ­é…''...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>ChIJy0NrQeSrQjQRVlv2fBcHVEA</td>\n","      <td>éå¸¸æ³° - å¾©èˆˆåº—</td>\n","      <td>OPERATIONAL</td>\n","      <td>False</td>\n","      <td>['restaurant', 'food', 'point_of_interest', 'e...</td>\n","      <td>4.4</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>1546.0</td>\n","      <td>2.0</td>\n","      <td>02 2546 6745</td>\n","      <td>...</td>\n","      <td>True</td>\n","      <td>{'lat': 25.0591667, 'lng': 121.5444444}</td>\n","      <td>['\\\\ç“¦åŸæ——ä¸‹æ™‚å°šåˆé£Ÿå°šçš„æ³°å¼é¤å»³ï¼/\\n\\nğŸ‘ğŸ¼ç™½é£¯åƒåˆ°é£½\\nğŸ‘ğŸ¼é£²æ–™è¶…å¥½å–\\nğŸ‘ğŸ¼ç”¨é¤...</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>True</td>\n","      <td>True</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>['ç”¨é¤', 'æ³°å¼', 'è¶…ç´š', 'è¦é¤…', 'æ™‚é–“', 'é¸æ“‡', 'é¤é»', 'ä¸é...</td>\n","      <td>''ç”¨é¤'', ''æ³°å¼'', ''è¶…ç´š'', ''è¦é¤…'', ''æ™‚é–“'', ''é¸æ“‡''...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5 rows Ã— 23 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a815de79-f258-4a1e-87d1-3909c50a823c')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-a815de79-f258-4a1e-87d1-3909c50a823c button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-a815de79-f258-4a1e-87d1-3909c50a823c');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-12890cc1-c066-460d-b4b0-ef34ce4a37f3\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-12890cc1-c066-460d-b4b0-ef34ce4a37f3')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-12890cc1-c066-460d-b4b0-ef34ce4a37f3 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe"}},"metadata":{},"execution_count":109}]},{"cell_type":"code","source":["max_length = max(len(level1_country), len(level2_foodname), len(level3_taste))\n","df_dic = pd.DataFrame({\n","    \"id\":np.arange(1, max_length + 1),\n","    \"Country\":pd.Series(level1_country),\n","    \"Food Name\":pd.Series(level2_foodname),\n","    \"Taste\":pd.Series(level3_taste)\n","    })"],"metadata":{"id":"agjaXts4Fmyk"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_dic.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"lpj5UaOMZ5ww","executionInfo":{"status":"ok","timestamp":1712339801430,"user_tz":-480,"elapsed":518,"user":{"displayName":"ç‹æ™´","userId":"13545761289751374787"}},"outputId":"ad9ddf77-5fb5-4757-97b3-02ca9164050d"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   id Country Food Name Taste\n","0   1   é˜¿çˆ¾åŠåˆ©äº        æ¿ƒæ¹¯    æŸ”è»Ÿ\n","1   2      è¥¿é¤        èµ·å¸    ç¶¿æ»‘\n","2   3     å®‰å“¥æ‹‰        è±†è‹—   è¥¿è¥¿é‡Œ\n","3   4      è²å—        è›‹å¡”    é…¥è„†\n","4   5     æ³¢æœ­é‚£        é±¸é­š    é†‹æºœ"],"text/html":["\n","  <div id=\"df-3dcbe2a1-c585-4db2-bde7-a3d92d61d4b8\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>Country</th>\n","      <th>Food Name</th>\n","      <th>Taste</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>é˜¿çˆ¾åŠåˆ©äº</td>\n","      <td>æ¿ƒæ¹¯</td>\n","      <td>æŸ”è»Ÿ</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>è¥¿é¤</td>\n","      <td>èµ·å¸</td>\n","      <td>ç¶¿æ»‘</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>å®‰å“¥æ‹‰</td>\n","      <td>è±†è‹—</td>\n","      <td>è¥¿è¥¿é‡Œ</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>è²å—</td>\n","      <td>è›‹å¡”</td>\n","      <td>é…¥è„†</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>æ³¢æœ­é‚£</td>\n","      <td>é±¸é­š</td>\n","      <td>é†‹æºœ</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-3dcbe2a1-c585-4db2-bde7-a3d92d61d4b8')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-3dcbe2a1-c585-4db2-bde7-a3d92d61d4b8 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-3dcbe2a1-c585-4db2-bde7-a3d92d61d4b8');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-5a435063-a873-44f3-87cf-9634868a33d1\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-5a435063-a873-44f3-87cf-9634868a33d1')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-5a435063-a873-44f3-87cf-9634868a33d1 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"df_dic","summary":"{\n  \"name\": \"df_dic\",\n  \"rows\": 623,\n  \"fields\": [\n    {\n      \"column\": \"id\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 179,\n        \"min\": 1,\n        \"max\": 623,\n        \"num_unique_values\": 623,\n        \"samples\": [\n          250,\n          559,\n          175\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Country\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 287,\n        \"samples\": [\n          \"\\u7dad\\u5fb7\\u89d2\",\n          \"\\u6258\\u514b\\u52de\",\n          \"\\u7acb\\u9676\\u5b9b\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Food Name\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 587,\n        \"samples\": [\n          \"\\u751f\\u8814\",\n          \"\\u6d77\\u9bae\\u8c46\\u8150\\u7fb9\",\n          \"\\u53ef\\u980c\\u9eb5\\u5305\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Taste\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 121,\n        \"samples\": [\n          \"\\u8591\",\n          \"\\u5c71\\u67f0\",\n          \"\\u918b\\u6e9c\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":98}]},{"cell_type":"code","source":["df_dic_path = '/gdrive/Shareddrives/å¾è³‡æ–™å­¸ç¿’2/Dataset & code/cleaning data/df_dic.csv'\n","df_dic.to_csv(df_dic_path,index=False)"],"metadata":{"id":"e4lr8FI5FqIS"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from google.colab import drive\n","drive.mount('/gdrive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"hgeYFcemN9s3","executionInfo":{"status":"ok","timestamp":1712323383124,"user_tz":-480,"elapsed":21070,"user":{"displayName":"ç‹æ™´","userId":"13545761289751374787"}},"outputId":"672e28bf-0194-48c3-a18b-87dcddaaf8be"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /gdrive\n"]}]},{"cell_type":"code","source":["df = df.loc[~df['keywords'].str.contains(r'\\[\\]')]"],"metadata":{"id":"JQYSkihdCZHZ"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import re\n","\n","def match_keywords(keywords, col_name, df_dic):\n","    matches = []\n","    for _, row in df_dic.iterrows():\n","        keyword_patterns = [re.escape(word) for word in str(row[col_name]).lower().split()]\n","        if any(re.search(r'\\b' + pattern + r'\\b', str(keywords).lower()) for pattern in keyword_patterns):\n","            matches.append(row[col_name])\n","    return ', '.join(matches)\n","\n","df[\"Country\"] = df[\"keywords_processed\"].apply(lambda x: match_keywords(x, \"Country\", df_dic),meta=('Country', 'object'))\n","df[\"Food Name\"] = df[\"keywords_processed\"].apply(lambda x: match_keywords(x, \"Food Name\", df_dic),meta=('Food Name', 'object'))\n","df[\"Taste\"] = df[\"keywords_processed\"].apply(lambda x: match_keywords(x, \"Taste\", df_dic),meta=('Taste', 'object'))"],"metadata":{"id":"vr6g_EfwBsui"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["def match_keywords(keywords, col_column, df_dic):\n","  match = []\n","  for keywords in df():\n","    if any(keywords):\n","       match.append(row[col_name])"],"metadata":{"id":"a0n_CvRJsWYt"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["def process_keywords(keywords_str):\n","    if isinstance(keywords_str, str):\n","        # Remove '[' and ']' characters from the string\n","        keywords_str = keywords_str.replace('[', '').replace(']', '')\n","        keywords_list = keywords_str.split(',')\n","        # Strip leading and trailing spaces from each keyword\n","        keywords_list = [keyword.strip() for keyword in keywords_list]\n","        return keywords_list\n","    else:\n","        return []\n","\n","# Apply the process_keywords function to the 'keywords' column\n","df['keywords_processed'] = df['keywords'].apply(process_keywords, meta=('object'))\n","\n","def match_keywords(keywords_list, col_name, df_dic):\n","    matches = []\n","    for _, row in df_dic.iterrows():\n","        for keyword in keywords_list:\n","            if keyword.lower() in str(row[col_name]).lower().split():\n","                matches.append(row[col_name])\n","    return ', '.join(set(matches))\n","\n","df[\"Country\"] = df[\"keywords_processed\"].apply(lambda x: match_keywords(x, \"Country\", df_dic), meta=('Country', 'object'))\n","df[\"Food Name\"] = df[\"keywords_processed\"].apply(lambda x: match_keywords(x, \"Food Name\", df_dic), meta=('Food Name', 'object'))\n","df[\"Taste\"] = df[\"keywords_processed\"].apply(lambda x: match_keywords(x, \"Taste\", df_dic), meta=('Taste', 'object'))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Cq8cu9i4xc-v","executionInfo":{"status":"ok","timestamp":1712338726225,"user_tz":-480,"elapsed":2033,"user":{"displayName":"ç‹æ™´","userId":"13545761289751374787"}},"outputId":"155a29f1-e777-45fd-a36d-cd3159122100"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.10/dist-packages/dask/dataframe/core.py:7084: FutureWarning: Meta is not valid, `map_partitions` and `map_overlap` expects output to be a pandas object. Try passing a pandas object as meta or a dict or tuple representing the (name, dtype) of the columns. In the future the meta you passed will not work.\n","  warnings.warn(\n"]}]},{"cell_type":"code","source":["df.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":294},"id":"7uRnYsiIVfVJ","executionInfo":{"status":"error","timestamp":1712339750014,"user_tz":-480,"elapsed":1022665,"user":{"displayName":"ç‹æ™´","userId":"13545761289751374787"}},"outputId":"50f063e7-bf00-4640-ccdb-a9a3c65d465c"},"execution_count":null,"outputs":[{"output_type":"error","ename":"KeyboardInterrupt","evalue":"","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)","\u001b[0;32m<ipython-input-97-c42a15b2c7cf>\u001b[0m in \u001b[0;36m<cell line: 1>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mdf\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mhead\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/dask/dataframe/core.py\u001b[0m in \u001b[0;36mhead\u001b[0;34m(self, n, npartitions, compute)\u001b[0m\n\u001b[1;32m   1436\u001b[0m         \u001b[0;31m# No need to warn if we're already looking at all partitions\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1437\u001b[0m         \u001b[0msafe\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnpartitions\u001b[0m \u001b[0;34m!=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mnpartitions\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1438\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_head\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mn\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mn\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mnpartitions\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mnpartitions\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcompute\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mcompute\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0msafe\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0msafe\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1439\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1440\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m_head\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mn\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mnpartitions\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcompute\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0msafe\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/dask/dataframe/core.py\u001b[0m in \u001b[0;36m_head\u001b[0;34m(self, n, npartitions, compute, safe)\u001b[0m\n\u001b[1;32m   1470\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1471\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mcompute\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1472\u001b[0;31m             \u001b[0mresult\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mresult\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcompute\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1473\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mresult\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1474\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/dask/base.py\u001b[0m in \u001b[0;36mcompute\u001b[0;34m(self, **kwargs)\u001b[0m\n\u001b[1;32m    379\u001b[0m         \u001b[0mdask\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcompute\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    380\u001b[0m         \"\"\"\n\u001b[0;32m--> 381\u001b[0;31m         \u001b[0;34m(\u001b[0m\u001b[0mresult\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mcompute\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtraverse\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mFalse\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    382\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mresult\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    383\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/dask/base.py\u001b[0m in \u001b[0;36mcompute\u001b[0;34m(traverse, optimize_graph, scheduler, get, *args, **kwargs)\u001b[0m\n\u001b[1;32m    664\u001b[0m         \u001b[0mpostcomputes\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mappend\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mx\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__dask_postcompute__\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    665\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 666\u001b[0;31m     \u001b[0mresults\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mschedule\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdsk\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mkeys\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    667\u001b[0m     \u001b[0;32mreturn\u001b[0m \u001b[0mrepack\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mf\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mr\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m*\u001b[0m\u001b[0ma\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mr\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0mf\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0ma\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mzip\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mresults\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mpostcomputes\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    668\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/dask/threaded.py\u001b[0m in \u001b[0;36mget\u001b[0;34m(dsk, keys, cache, num_workers, pool, **kwargs)\u001b[0m\n\u001b[1;32m     87\u001b[0m             \u001b[0mpool\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mMultiprocessingPoolExecutor\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mpool\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     88\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 89\u001b[0;31m     results = get_async(\n\u001b[0m\u001b[1;32m     90\u001b[0m         \u001b[0mpool\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msubmit\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     91\u001b[0m         \u001b[0mpool\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_max_workers\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/dask/local.py\u001b[0m in \u001b[0;36mget_async\u001b[0;34m(submit, num_workers, dsk, result, cache, get_id, rerun_exceptions_locally, pack_exception, raise_exception, callbacks, dumps, loads, chunksize, **kwargs)\u001b[0m\n\u001b[1;32m    498\u001b[0m             \u001b[0;32mwhile\u001b[0m \u001b[0mstate\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m\"waiting\"\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;32mor\u001b[0m \u001b[0mstate\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m\"ready\"\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;32mor\u001b[0m \u001b[0mstate\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m\"running\"\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    499\u001b[0m                 \u001b[0mfire_tasks\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mchunksize\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 500\u001b[0;31m                 \u001b[0;32mfor\u001b[0m \u001b[0mkey\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mres_info\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mfailed\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mqueue_get\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mqueue\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mresult\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    501\u001b[0m                     \u001b[0;32mif\u001b[0m \u001b[0mfailed\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    502\u001b[0m                         \u001b[0mexc\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtb\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mloads\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mres_info\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/dask/local.py\u001b[0m in \u001b[0;36mqueue_get\u001b[0;34m(q)\u001b[0m\n\u001b[1;32m    135\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    136\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mqueue_get\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mq\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 137\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mq\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    138\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    139\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/lib/python3.10/queue.py\u001b[0m in \u001b[0;36mget\u001b[0;34m(self, block, timeout)\u001b[0m\n\u001b[1;32m    169\u001b[0m             \u001b[0;32melif\u001b[0m \u001b[0mtimeout\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    170\u001b[0m                 \u001b[0;32mwhile\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_qsize\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 171\u001b[0;31m                     \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mnot_empty\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mwait\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    172\u001b[0m             \u001b[0;32melif\u001b[0m \u001b[0mtimeout\u001b[0m \u001b[0;34m<\u001b[0m \u001b[0;36m0\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    173\u001b[0m                 \u001b[0;32mraise\u001b[0m \u001b[0mValueError\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"'timeout' must be a non-negative number\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/lib/python3.10/threading.py\u001b[0m in \u001b[0;36mwait\u001b[0;34m(self, timeout)\u001b[0m\n\u001b[1;32m    318\u001b[0m         \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m    \u001b[0;31m# restore state no matter what (e.g., KeyboardInterrupt)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    319\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mtimeout\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 320\u001b[0;31m                 \u001b[0mwaiter\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0macquire\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    321\u001b[0m                 \u001b[0mgotit\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mTrue\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    322\u001b[0m             \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mKeyboardInterrupt\u001b[0m: "]}]},{"cell_type":"code","source":["output_df_path = '/gdrive/Shareddrives/å¾è³‡æ–™å­¸ç¿’2/Dataset & code/cleaning data/restaurant_label2.csv'\n","df.to_csv(output_df_path, index=False, single_file=True)"],"metadata":{"id":"DRbp6CNAOUlL"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import pandas as pd\n","\n","# Create a helper function to match keywords\n","def match_keywords(keywords, col_name, df_dic):\n","    keywords = [keyword.lower() for keyword in keywords]\n","    matches = []\n","    for _, row in df_dic.iterrows():\n","        row_value = str(row[col_name]).lower()\n","        if any(keyword in row_value for keyword in keywords):\n","            matches.append(row[col_name])\n","    return ', '.join(matches)\n","\n","# Apply the match_keywords function to create the new columns\n","df['Country'] = df['keywords_processed'].apply(lambda x: match_keywords(x, 'Country', df_dic), meta=('Country', 'object'))\n","df['Food Name'] = df['keywords_processed'].apply(lambda x: match_keywords(x, 'Food Name', df_dic), meta=('Food Name', 'object'))\n","df['Taste'] = df['keywords_processed'].apply(lambda x: match_keywords(x, 'Taste', df_dic), meta=('Taste', 'object'))\n","\n","# Display the resulting DataFrame\n","print(df[['place_id', 'name', 'Country', 'Food Name', 'Taste']])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"JBWfIrUrabQQ","executionInfo":{"status":"ok","timestamp":1712340163953,"user_tz":-480,"elapsed":427,"user":{"displayName":"ç‹æ™´","userId":"13545761289751374787"}},"outputId":"ac48e1b3-fd5a-47a7-dc25-ca1cfe4ca580"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Dask DataFrame Structure:\n","              place_id    name Country Food Name   Taste\n","npartitions=1                                           \n","                string  string  string    string  string\n","                   ...     ...     ...       ...     ...\n","Dask Name: getitem, 19 graph layers\n"]}]},{"cell_type":"code","source":["df.head(1)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":294},"id":"XyNLs3iJaz3Z","executionInfo":{"status":"error","timestamp":1712340294014,"user_tz":-480,"elapsed":1730,"user":{"displayName":"ç‹æ™´","userId":"13545761289751374787"}},"outputId":"471ffffc-1932-4961-c990-0fbb8baf5c4f"},"execution_count":null,"outputs":[{"output_type":"error","ename":"TypeError","evalue":"sequence item 25: expected str instance, float found","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mTypeError\u001b[0m                                 Traceback (most recent call last)","\u001b[0;32m<ipython-input-112-c11b9b275432>\u001b[0m in \u001b[0;36m<cell line: 1>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mdf\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mhead\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/dask/threaded.py\u001b[0m in \u001b[0;36mget\u001b[0;34m(dsk, keys, cache, num_workers, pool, **kwargs)\u001b[0m\n\u001b[1;32m     87\u001b[0m             \u001b[0mpool\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mMultiprocessingPoolExecutor\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mpool\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     88\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 89\u001b[0;31m     results = get_async(\n\u001b[0m\u001b[1;32m     90\u001b[0m         \u001b[0mpool\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msubmit\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     91\u001b[0m         \u001b[0mpool\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_max_workers\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/dask/local.py\u001b[0m in \u001b[0;36mget_async\u001b[0;34m(submit, num_workers, dsk, result, cache, get_id, rerun_exceptions_locally, pack_exception, raise_exception, callbacks, dumps, loads, chunksize, **kwargs)\u001b[0m\n\u001b[1;32m    509\u001b[0m                             \u001b[0m_execute_task\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtask\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m  \u001b[0;31m# Re-execute locally\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    510\u001b[0m                         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 511\u001b[0;31m                             \u001b[0mraise_exception\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mexc\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtb\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    512\u001b[0m                     \u001b[0mres\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mworker_id\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mloads\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mres_info\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    513\u001b[0m                     \u001b[0mstate\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m\"cache\"\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mkey\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mres\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/dask/local.py\u001b[0m in \u001b[0;36mreraise\u001b[0;34m(exc, tb)\u001b[0m\n\u001b[1;32m    317\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0mexc\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__traceback__\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0mtb\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    318\u001b[0m         \u001b[0;32mraise\u001b[0m \u001b[0mexc\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mwith_traceback\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtb\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 319\u001b[0;31m     \u001b[0;32mraise\u001b[0m \u001b[0mexc\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    320\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    321\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/dask/local.py\u001b[0m in \u001b[0;36mexecute_task\u001b[0;34m(key, task_info, dumps, loads, get_id, pack_exception)\u001b[0m\n\u001b[1;32m    222\u001b[0m     \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    223\u001b[0m         \u001b[0mtask\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdata\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mloads\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtask_info\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 224\u001b[0;31m         \u001b[0mresult\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0m_execute_task\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtask\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    225\u001b[0m         \u001b[0mid\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mget_id\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    226\u001b[0m         \u001b[0mresult\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mdumps\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mresult\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mid\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pandas/_libs/lib.pyx\u001b[0m in \u001b[0;36mpandas._libs.lib.map_infer\u001b[0;34m()\u001b[0m\n","\u001b[0;32m<ipython-input-110-561c3f194f75>\u001b[0m in \u001b[0;36m<lambda>\u001b[0;34m(x)\u001b[0m\n\u001b[1;32m     12\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     13\u001b[0m \u001b[0;31m# Apply the match_keywords function to create the new columns\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 14\u001b[0;31m \u001b[0mdf\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'Country'\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mdf\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'keywords_processed'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mapply\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;32mlambda\u001b[0m \u001b[0mx\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mmatch_keywords\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mx\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'Country'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdf_dic\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmeta\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'Country'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'object'\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     15\u001b[0m \u001b[0mdf\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'Food Name'\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mdf\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'keywords_processed'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mapply\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;32mlambda\u001b[0m \u001b[0mx\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mmatch_keywords\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mx\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'Food Name'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdf_dic\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmeta\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'Food Name'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'object'\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     16\u001b[0m \u001b[0mdf\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'Taste'\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mdf\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'keywords_processed'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mapply\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;32mlambda\u001b[0m \u001b[0mx\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mmatch_keywords\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mx\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'Taste'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdf_dic\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmeta\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'Taste'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'object'\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m<ipython-input-110-561c3f194f75>\u001b[0m in \u001b[0;36mmatch_keywords\u001b[0;34m(keywords, col_name, df_dic)\u001b[0m\n\u001b[1;32m      9\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0many\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mkeyword\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mrow_value\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mkeyword\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mkeywords\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     10\u001b[0m             \u001b[0mmatches\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mappend\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mrow\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mcol_name\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 11\u001b[0;31m     \u001b[0;32mreturn\u001b[0m \u001b[0;34m', '\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mjoin\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmatches\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     12\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     13\u001b[0m \u001b[0;31m# Apply the match_keywords function to create the new columns\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mTypeError\u001b[0m: sequence item 25: expected str instance, float found"]}]}],"metadata":{"colab":{"provenance":[]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}